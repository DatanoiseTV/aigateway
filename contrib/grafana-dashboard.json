{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 10, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
      "id": 1,
      "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sum(rate(ai_gateway_requests_total[5m])) by (client_id)",
          "legendFormat": "{{client_id}}",
          "refId": "A"
        }
      ],
      "title": "Requests Rate (by client)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 10, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
      "id": 2,
      "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "ai_gateway_requests_in_progress",
          "legendFormat": "In Progress",
          "refId": "A"
        }
      ],
      "title": "Requests In Progress",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 50}, {"color": "red", "value": 100}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 4, "w": 6, "x": 0, "y": 8},
      "id": 3,
      "options": {"orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showThresholdLabels": false, "showThresholdMarkers": true, "text": {}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sum(ai_gateway_requests_total)",
          "refId": "A"
        }
      ],
      "title": "Total Requests",
      "type": "gauge"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 4, "w": 6, "x": 6, "y": 8},
      "id": 4,
      "options": {"orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showThresholdLabels": false, "showThresholdMarkers": true, "text": {}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "ai_gateway_active_clients",
          "refId": "A"
        }
      ],
      "title": "Active Clients",
      "type": "gauge"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 10, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 12},
      "id": 5,
      "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sum(rate(ai_gateway_input_tokens_total[5m])) by (client_id)",
          "legendFormat": "{{client_id}} input",
          "refId": "A"
        },
        {
          "expr": "sum(rate(ai_gateway_output_tokens_total[5m])) by (client_id)",
          "legendFormat": "{{client_id}} output",
          "refId": "B"
        }
      ],
      "title": "Token Rate (input/output)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 10, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 12},
      "id": 6,
      "options": {"legend": {"calcs": ["mean", "lastNotNull"], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(ai_gateway_request_duration_seconds_bucket[5m])) by (le, client_id))",
          "legendFormat": "{{client_id}} p95",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.50, sum(rate(ai_gateway_request_duration_seconds_bucket[5m])) by (le, client_id))",
          "legendFormat": "{{client_id}} p50",
          "refId": "B"
        }
      ],
      "title": "Request Duration (p50/p95)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "bars", "fillOpacity": 70, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": false},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "red", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 20},
      "id": 7,
      "options": {"legend": {"calcs": ["sum"], "displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sum by (status) (increase(ai_gateway_requests_total[1m]))",
          "legendFormat": "HTTP {{status}}",
          "refId": "A"
        }
      ],
      "title": "Requests by Status (per minute)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 1}, {"color": "red", "value": 10}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 4, "w": 6, "x": 0, "y": 28},
      "id": 8,
      "options": {"orientation": "auto", "reduceOptions": {"calcs": ["sum"], "fields": "", "values": false}, "showThresholdLabels": false, "showThresholdMarkers": true, "text": {}},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sum(increase(ai_gateway_upstream_errors_total[5m]))",
          "refId": "A"
        }
      ],
      "title": "Upstream Errors (5m)",
      "type": "gauge"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"align": "auto", "displayMode": "auto", "filterable": false},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}
        },
        "overrides": []
      },
      "gridPos": {"h": 8, "w": 12, "x": 6, "y": 28},
      "id": 9,
      "options": {"showHeader": true},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "topk(10, ai_gateway_input_tokens_total)",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "title": "Top Clients by Input Tokens",
      "transformations": [{"id": "organize", "options": {"excludeByName": {"Time": true}, "renameByName": {"Value": "Input Tokens", "client_id": "Client", "model": "Model"}}}],
      "type": "table"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"align": "auto", "displayMode": "auto", "filterable": false},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}
        },
        "overrides": []
      },
      "gridPos": {"h": 8, "w": 12, "x": 18, "y": 28},
      "id": 10,
      "options": {"showHeader": true},
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "topk(10, ai_gateway_output_tokens_total)",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "title": "Top Clients by Output Tokens",
      "transformations": [{"id": "organize", "options": {"excludeByName": {"Time": true}, "renameByName": {"Value": "Output Tokens", "client_id": "Client", "model": "Model"}}}],
      "type": "table"
    }
  ],
  "refresh": "10s",
  "schemaVersion": 27,
  "style": "dark",
  "tags": ["ai-gateway", "prometheus"],
  "templating": {"list": []},
  "time": {"from": "now-1h", "to": "now"},
  "timepicker": {},
  "timezone": "",
  "title": "AI Gateway Dashboard",
  "uid": "ai-gateway",
  "version": 1
}
